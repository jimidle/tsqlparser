(aaa_translation_unit (batch_statements (statements (sql_statements (use_statement USE (keyw_id (keyw_id_part (func_keyw_id (keywords master)))) ;))) (statements GO) (statements (ddl_statements (create_statement CREATE (create_login LOGIN (keyw_id (keyw_id_part (func_keyw_id login_test))) (cl_from_with WITH (cl_option_list PASSWORD = '3KHJ6dhx(0xVYsdf' MUST_CHANGE , (cl_option CHECK_EXPIRATION = ON))) ;)))) (statements GO) (statements (ddl_statements (permissions_ddl (grant_statement GRANT (permission_set (permission_set_element (permission_name (permission_spec VIEW SERVER STATE)))) (permission_to TO (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id login_test))))) ;)))) (statements GO) (statements (ddl_statements (create_statement CREATE (create_trigger TRIGGER (keyw_id (keyw_id_part (func_keyw_id connection_limit_trigger))) ON (trig_ddl (trig_ddl_stuff ALL SERVER (trig_with WITH (trigger_option_list (trigger_option (execute_as_clause EXECUTE AS 'login_test')))) FOR LOGON (trigger_body AS (unblocked_statements (begin_statement BEGIN (statement_block (statements (sql_statements (miscellaneous_statements (if_statement IF (search_condition (predicate (expression (expression (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id ORIGINAL_LOGIN))))) (function_args ( ))))) = (expression (atoms 'login_test'))) AND (expression (expression (paren_sub_query ( (sub_query (select_statement (query_expression (query_specification SELECT (select_list (select_element (expression (functions_and_vars (aggregate_windowed_functions COUNT ( * )))))) (from_clause FROM (table_source_list (table_source (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id (keywords sys))) . (keyw_id_part (func_keyw_id dm_exec_sessions))))))))) (where_clause WHERE (search_condition (predicate (expression (expression (expression (keyw_id_part (func_keyw_id is_user_process))) = (expression (atoms 1))) AND (expression (expression (keyw_id_part (func_keyw_id original_login_name))) = (expression (atoms 'login_test'))))))))))) ))) > (expression (atoms 3)))))) (statements (sql_statements (miscellaneous_statements (rollbacksave_statement ROLLBACK ;))))))))) END ;)))))))))) <EOF>)