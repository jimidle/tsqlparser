
(aaa_translation_unit 
  (batch_statements 
    (statements 
      (sql_statements 
        (select_statement 
          (query_expression 
            (query_specification select 
              (select_list 
                (select_element 
                  (expression 
                    (keyw_id_part 
                      (func_keyw_id mid_buyer
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id mid
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions min 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id qty_ship
                                          )
                                        )
                                      ) > 
                                      (expression 
                                        (atoms 0
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id order_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms NULL
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id first_purchase
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id qty_ship
                                          )
                                        )
                                      ) > 
                                      (expression 
                                        (atoms 0
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id order_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms NULL
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id last_purchase
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions min 
                        ( 
                          (expression 
                            (keyw_id_part 
                              (func_keyw_id order_date
                              )
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id first_order
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (keyw_id_part 
                              (func_keyw_id order_date
                              )
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id last_order
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id keycode_source
                                          )
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id catalog_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id qty_ship
                                          )
                                        )
                                      ) > 
                                      (expression 
                                        (atoms 0
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (expression 
                                            (keyw_id_part 
                                              (func_keyw_id qty_ship
                                              )
                                            )
                                          ) > 
                                          (expression 
                                            (atoms 0
                                            )
                                          )
                                        ) and 
                                        (expression 
                                          (expression 
                                            (keyw_id_part 
                                              (func_keyw_id order_type
                                              )
                                            )
                                          ) = 
                                          (expression 
                                            (atoms 'W'
                                            )
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id channel
                                          )
                                        )
                                      )
                                    ) is null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id web_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id order_type
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'W'
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id online_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id order_type
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'R'
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id retail_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id channel
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'ACMS'
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id cs_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id nike_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 1
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id nike_id_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id b
                                            )
                                          )
                                        ) . 
                                        (expression 
                                          (expression 
                                            (keyw_id_part 
                                              (func_keyw_id gender
                                              )
                                            )
                                          ) = 
                                          (expression 
                                            (atoms 'MENS'
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id mens_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id b
                                            )
                                          )
                                        ) . 
                                        (expression 
                                          (expression 
                                            (keyw_id_part 
                                              (func_keyw_id gender
                                              )
                                            )
                                          ) = 
                                          (expression 
                                            (atoms 'WOMENS'
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id womens_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id a
                                            )
                                          )
                                        ) . 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id clearance_store_id
                                            )
                                          )
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id clearance_store_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (case_expression case 
                      (case_boolean_when_clause when 
                        (search_condition 
                          (predicate 
                            (expression 
                              (expression 
                                (expression 
                                  (functions_and_vars 
                                    (aggregate_windowed_functions max 
                                      ( 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_return
                                            )
                                          )
                                        ) 
                                      )
                                    )
                                  )
                                ) > 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) and 
                              (expression 
                                (expression 
                                  (functions_and_vars 
                                    (aggregate_windowed_functions max 
                                      ( 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id isnull
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id qty_ship
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (atoms 0
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        ) 
                                      )
                                    )
                                  )
                                ) = 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              )
                            )
                          )
                        ) then 
                        (expression 
                          (atoms 1
                          )
                        )
                      ) 
                      (case_else else 
                        (expression 
                          (atoms 0
                          )
                        )
                      ) end
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id returner
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id clientele_order
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 1
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id clientele_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id qty_ship
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (atoms 0
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id keycode_attributed_retail
                                          )
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id dm_buyer
                    )
                  )
                )
              ) 
              (into_clause into 
                (keyw_id 
                  (keyw_id_part 
                    (func_keyw_id agg
                    )
                  ) . 
                  (keyw_id_part 
                    (func_keyw_id dbo
                    )
                  ) . 
                  (keyw_id_part 
                    (func_keyw_id orders_rollup
                    )
                  )
                )
              ) 
              (from_clause from 
                (table_source_list 
                  (table_source 
                    (tableSourceElement 
                      (table_source_primitive 
                        (primitive_table 
                          (keyw_id 
                            (keyw_id_part 
                              (func_keyw_id agg
                              )
                            ) . 
                            (keyw_id_part 
                              (func_keyw_id dbo
                              )
                            ) . 
                            (keyw_id_part 
                              (func_keyw_id orders_agg
                              )
                            )
                          ) 
                          (as_clause 
                            (func_keyw_id a
                            )
                          ) 
                          (table_hints 
                            ( 
                              (table_hint_list 
                                (table_hint nolock
                                )
                              ) 
                            )
                          )
                        )
                      ) 
                      (join_type_prefix left
                      ) join 
                      (tableSourceElement 
                        (table_source_primitive 
                          (primitive_table 
                            (keyw_id 
                              (keyw_id_part 
                                (func_keyw_id kc
                                )
                              ) . 
                              (keyw_id_part 
                                (func_keyw_id dbo
                                )
                              ) . 
                              (keyw_id_part 
                                (func_keyw_id lkp_custom_class
                                )
                              )
                            ) 
                            (as_clause 
                              (func_keyw_id b
                              )
                            )
                          )
                        )
                      ) 
                      (on_join on 
                        (search_condition 
                          (predicate 
                            (expression 
                              (expression 
                                (keyw_id_part 
                                  (func_keyw_id a
                                  )
                                )
                              ) . 
                              (expression 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id custom_class_id
                                    )
                                  )
                                ) = 
                                (expression 
                                  (expression 
                                    (keyw_id_part 
                                      (func_keyw_id b
                                      )
                                    )
                                  ) . 
                                  (expression 
                                    (keyw_id_part 
                                      (func_keyw_id custom_class_id
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              ) 
              (group_by_clause group by 
                (expression_list 
                  (expression 
                    (keyw_id_part 
                      (func_keyw_id mid_buyer
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
    )
  ) <EOF>
)