(aaa_translation_unit (batch_statements (statements (sql_statements (select_statement (query_expression (query_specification select (select_list (select_element (expression (expression (keyw_id_part (func_keyw_id a))) . (expression (keyw_id_part (func_keyw_id mid))))) , (select_element (expression (atoms 1)) (as_clause as (func_keyw_id retail_catalog_buyer)))) (into_clause into (keyw_id (keyw_id_part (func_keyw_id agg)) . (keyw_id_part (func_keyw_id dbo)) . (keyw_id_part (func_keyw_id retail_catalog_buyer)))) (from_clause from (table_source_list (table_source (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id campaign)) . (keyw_id_part (func_keyw_id dbo)) . (keyw_id_part (func_keyw_id communication))) (as_clause (func_keyw_id a)))) join_type_prefix join (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id agg)) . (keyw_id_part (func_keyw_id dbo)) . (keyw_id_part (func_keyw_id orders_agg))) (as_clause (func_keyw_id b))))) (on_join on (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id a))) . (expression (expression (keyw_id_part (func_keyw_id mid))) = (expression (expression (keyw_id_part (func_keyw_id b))) . (expression (keyw_id_part (func_keyw_id mid_buyer))))))))) join_type_prefix join (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id campaign)) . (keyw_id_part (func_keyw_id dbo)) . (keyw_id_part (func_keyw_id lkp_keycode))) (as_clause (func_keyw_id c))))) (on_join on (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id a))) . (expression (expression (keyw_id_part (func_keyw_id keycode))) = (expression (expression (keyw_id_part (func_keyw_id c))) . (expression (keyw_id_part (func_keyw_id keycode))))))))) join_type_prefix join (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id kc)) . . (keyw_id_part (func_keyw_id lkp_store))) (as_clause (func_keyw_id d))))) (on_join on (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id d))) . (expression (expression (keyw_id_part (func_keyw_id store_id))) = (expression (expression (keyw_id_part (func_keyw_id b))) . (expression (keyw_id_part (func_keyw_id store_id))))))))))))) (where_clause where (search_condition (predicate (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id DATEDIFF))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (keyw_id_part (func_keyw_id dd)))) , (param_list_el (expression (expression (keyw_id_part (func_keyw_id a))) . (expression (keyw_id_part (func_keyw_id inhome_date))))) , (param_list_el (expression (expression (keyw_id_part (func_keyw_id b))) . (expression (keyw_id_part (func_keyw_id order_date))))))) ))))) between (expression (expression (expression (atoms 0)) and (expression (atoms 30))) and (expression (expression (keyw_id_part (func_keyw_id d))) . (expression (keyw_id_part (func_keyw_id store_type_id))))) in)))))))) (statements (sql_statements (select_statement (query_expression (query_specification (paren_sub_query ( (sub_query (select_statement (query_expression (query_specification 'NT' , 'WMS')))) )))))))) and b . qty_ship > 0 group by a . mid)