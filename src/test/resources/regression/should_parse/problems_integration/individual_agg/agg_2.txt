
(aaa_translation_unit 
  (batch_statements 
    (statements 
      (sql_statements 
        (select_statement 
          (query_expression 
            (query_specification select 
              (select_list 
                (select_element 
                  (expression 
                    (expression 
                      (keyw_id_part 
                        (func_keyw_id a
                        )
                      )
                    ) . 
                    (expression 
                      (keyw_id_part 
                        (func_keyw_id mid
                        )
                      )
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions min 
                        ( 
                          (expression 
                            (keyw_id_part 
                              (func_keyw_id registration_date
                              )
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id first_registration
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (keyw_id_part 
                              (func_keyw_id registration_date
                              )
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id last_registration
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (search_condition 
                                    ( 
                                      (search_condition 
                                        (search_condition 
                                          ( 
                                            (search_condition 
                                              (predicate 
                                                (expression 
                                                  (expression 
                                                    (keyw_id_part 
                                                      (func_keyw_id registration_date
                                                      )
                                                    )
                                                  ) > 
                                                  (expression 
                                                    (keyw_id_part 
                                                      (func_keyw_id deregistration_date
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            ) 
                                          )
                                        ) or 
                                        (search_condition 
                                          (predicate 
                                            (expression 
                                              (keyw_id_part 
                                                (func_keyw_id deregistration_date
                                                )
                                              )
                                            ) is null
                                          )
                                        )
                                      ) 
                                    )
                                  ) and 
                                  (search_condition 
                                    (predicate 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id invalid
                                          )
                                        )
                                      ) is null
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id email_valid
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions min 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (expression 
                                            (functions_and_vars 
                                              (function 
                                                (func_name left
                                                ) 
                                                (function_args 
                                                  ( 
                                                    (param_list_or_all 
                                                      (param_list 
                                                        (param_list_el 
                                                          (expression 
                                                            (keyw_id_part 
                                                              (func_keyw_id cid
                                                              )
                                                            )
                                                          )
                                                        ) , 
                                                        (param_list_el 
                                                          (expression 
                                                            (atoms 4
                                                            )
                                                          )
                                                        )
                                                      )
                                                    ) 
                                                  )
                                                )
                                              )
                                            )
                                          ) = 
                                          (expression 
                                            (atoms 'ATGU'
                                            )
                                          )
                                        ) and 
                                        (expression 
                                          (expression 
                                            (keyw_id_part 
                                              (func_keyw_id first_name
                                              )
                                            )
                                          ) = 
                                          (expression 
                                            (atoms 'EMAILONLYUSER'
                                            )
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_name
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'EMAILONLYUSER'
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id email_only
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (search_condition 
                                    (search_condition 
                                      ( 
                                        (search_condition 
                                          (predicate 
                                            (expression 
                                              (expression 
                                                (expression 
                                                  (functions_and_vars 
                                                    (function 
                                                      (func_name 
                                                        (keyw_id_for_func 
                                                          (keyw_id_orcc 
                                                            (keyw_id_part 
                                                              (func_keyw_id isnull
                                                              )
                                                            )
                                                          )
                                                        )
                                                      ) 
                                                      (function_args 
                                                        ( 
                                                          (param_list_or_all 
                                                            (param_list 
                                                              (param_list_el 
                                                                (expression 
                                                                  (keyw_id_part 
                                                                    (func_keyw_id first_name
                                                                    )
                                                                  )
                                                                )
                                                              ) , 
                                                              (param_list_el 
                                                                (expression 
                                                                  (atoms ''
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          ) 
                                                        )
                                                      )
                                                    )
                                                  )
                                                ) <> 
                                                (expression 
                                                  (atoms 'EMAILONLYUSER'
                                                  )
                                                )
                                              ) or 
                                              (expression 
                                                (expression 
                                                  (functions_and_vars 
                                                    (function 
                                                      (func_name 
                                                        (keyw_id_for_func 
                                                          (keyw_id_orcc 
                                                            (keyw_id_part 
                                                              (func_keyw_id isnull
                                                              )
                                                            )
                                                          )
                                                        )
                                                      ) 
                                                      (function_args 
                                                        ( 
                                                          (param_list_or_all 
                                                            (param_list 
                                                              (param_list_el 
                                                                (expression 
                                                                  (keyw_id_part 
                                                                    (func_keyw_id last_name
                                                                    )
                                                                  )
                                                                )
                                                              ) , 
                                                              (param_list_el 
                                                                (expression 
                                                                  (atoms ''
                                                                  )
                                                                )
                                                              )
                                                            )
                                                          ) 
                                                        )
                                                      )
                                                    )
                                                  )
                                                ) <> 
                                                (expression 
                                                  (atoms 'EMAILONLYUSER'
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        ) 
                                      )
                                    ) and 
                                    (search_condition 
                                      ( 
                                        (search_condition 
                                          (search_condition 
                                            (predicate 
                                              (expression 
                                                (expression 
                                                  (keyw_id_part 
                                                    (func_keyw_id b
                                                    )
                                                  )
                                                ) . 
                                                (expression 
                                                  (keyw_id_part 
                                                    (func_keyw_id last_deregistration
                                                    )
                                                  )
                                                )
                                              ) is null
                                            )
                                          ) or 
                                          (search_condition 
                                            (predicate 
                                              (expression 
                                                (expression 
                                                  (keyw_id_part 
                                                    (func_keyw_id b
                                                    )
                                                  )
                                                ) . 
                                                (expression 
                                                  (expression 
                                                    (keyw_id_part 
                                                      (func_keyw_id last_registration
                                                      )
                                                    )
                                                  ) > 
                                                  (expression 
                                                    (expression 
                                                      (keyw_id_part 
                                                        (func_keyw_id b
                                                        )
                                                      )
                                                    ) . 
                                                    (expression 
                                                      (keyw_id_part 
                                                        (func_keyw_id last_deregistration
                                                        )
                                                      )
                                                    )
                                                  )
                                                )
                                              )
                                            )
                                          )
                                        ) 
                                      )
                                    )
                                  ) and 
                                  (search_condition 
                                    (predicate 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id b
                                            )
                                          )
                                        ) . 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id mid
                                            )
                                          )
                                        )
                                      ) is not null
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id registered
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (keyw_id_part 
                              (func_keyw_id us_active
                              )
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id us_registered
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id country
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'UNITED STATES'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 'U'
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (keyw_id_part 
                                        (func_keyw_id country
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 'F'
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms NULL
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id registration_country
                    )
                  )
                )
              ) 
              (into_clause into 
                (keyw_id 
                  (keyw_id_part 
                    (func_keyw_id agg
                    )
                  ) . 
                  (keyw_id_part 
                    (func_keyw_id dbo
                    )
                  ) . 
                  (keyw_id_part 
                    (func_keyw_id email_rollup
                    )
                  )
                )
              ) 
              (from_clause from 
                (table_source_list 
                  (table_source 
                    (tableSourceElement 
                      (table_source_primitive 
                        (primitive_table 
                          (keyw_id 
                            (keyw_id_part 
                              (func_keyw_id kc
                              )
                            ) . 
                            (keyw_id_part 
                              (func_keyw_id dbo
                              )
                            ) . 
                            (keyw_id_part 
                              (func_keyw_id email_view
                              )
                            )
                          ) 
                          (as_clause 
                            (func_keyw_id a
                            )
                          )
                        )
                      ) 
                      (join_type_prefix left
                      ) join 
                      (tableSourceElement 
                        (table_source_primitive 
                          (primitive_table 
                            (keyw_id 
                              (keyw_id_part 
                                (func_keyw_id agg
                                )
                              ) . 
                              (keyw_id_part 
                                (func_keyw_id dbo
                                )
                              ) . 
                              (keyw_id_part 
                                (func_keyw_id email_rollup_temp
                                )
                              )
                            ) 
                            (as_clause 
                              (func_keyw_id b
                              )
                            )
                          )
                        )
                      ) 
                      (on_join on 
                        (search_condition 
                          (predicate 
                            (expression 
                              (expression 
                                (keyw_id_part 
                                  (func_keyw_id a
                                  )
                                )
                              ) . 
                              (expression 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id mid
                                    )
                                  )
                                ) = 
                                (expression 
                                  (expression 
                                    (keyw_id_part 
                                      (func_keyw_id b
                                      )
                                    )
                                  ) . 
                                  (expression 
                                    (keyw_id_part 
                                      (func_keyw_id mid
                                      )
                                    )
                                  )
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              ) 
              (group_by_clause group by 
                (expression_list 
                  (expression 
                    (expression 
                      (keyw_id_part 
                        (func_keyw_id a
                        )
                      )
                    ) . 
                    (expression 
                      (keyw_id_part 
                        (func_keyw_id mid
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
    )
  ) <EOF>
)