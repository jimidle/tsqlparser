
(aaa_translation_unit 
  (batch_statements 
    (statements 
      (sql_statements 
        (select_statement 
          (query_expression 
            (query_specification select 
              (select_list 
                (select_element 
                  (expression 
                    (keyw_id_part 
                      (func_keyw_id mid
                      )
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'NT'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id first_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms null
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id first_purchase_niketown
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'NT'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id last_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms null
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id last_purchase_niketown
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'FAC'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id first_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms null
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id first_purchase_factory
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'FAC'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id last_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms null
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id last_purchase_factory
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'WMS'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id first_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms null
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id first_purchase_nikewomen
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'WMS'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id last_date
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms null
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id last_purchase_nikewomen
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id first_date
                                          )
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id factory_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id first_date
                                          )
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id nikewomen_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id first_date
                                          )
                                        )
                                      )
                                    ) is not null
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id niketown_buyer
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 3
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 6
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 2
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 9
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 3
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 12
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 4
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 18
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 5
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 24
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 6
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 36
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 7
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'FAC'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) <= 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 36
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 8
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id factory_recency
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 3
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 6
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 2
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 9
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 3
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 12
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 4
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 18
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 5
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 24
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 6
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 36
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 7
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'WMS'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) <= 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 36
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 8
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id nikewomen_recency
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions max 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 3
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 1
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 6
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 2
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 9
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 3
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 12
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 4
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 18
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 5
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 24
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 6
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) > 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 36
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 7
                                  )
                                )
                              ) 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id store_type_id
                                            )
                                          )
                                        ) = 
                                        (expression 
                                          (atoms 'NT'
                                          )
                                        )
                                      ) and 
                                      (expression 
                                        (expression 
                                          (keyw_id_part 
                                            (func_keyw_id last_date
                                            )
                                          )
                                        ) <= 
                                        (expression 
                                          (functions_and_vars 
                                            (function 
                                              (func_name 
                                                (keyw_id_for_func 
                                                  (keyw_id_orcc 
                                                    (keyw_id_part 
                                                      (func_keyw_id dateadd
                                                      )
                                                    )
                                                  )
                                                )
                                              ) 
                                              (function_args 
                                                ( 
                                                  (param_list_or_all 
                                                    (param_list 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id mm
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression - 
                                                          (expression 
                                                            (atoms 36
                                                            )
                                                          )
                                                        )
                                                      ) , 
                                                      (param_list_el 
                                                        (expression 
                                                          (keyw_id_part 
                                                            (func_keyw_id @maxorder
                                                            )
                                                          )
                                                        )
                                                      )
                                                    )
                                                  ) 
                                                )
                                              )
                                            )
                                          )
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (atoms 8
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id niketown_recency
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions sum 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'FAC'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id demand
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id factory_demand
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions sum 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'WMS'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id demand
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id nikewomen_demand
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions sum 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'NT'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id demand
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id niketown_demand
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions sum 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'FAC'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id order_count
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id factory_frequency
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions sum 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'WMS'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id order_count
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id nikewomen_frequency
                    )
                  )
                ) , 
                (select_element 
                  (expression 
                    (functions_and_vars 
                      (aggregate_windowed_functions sum 
                        ( 
                          (expression 
                            (case_expression case 
                              (case_boolean_when_clause when 
                                (search_condition 
                                  (predicate 
                                    (expression 
                                      (expression 
                                        (keyw_id_part 
                                          (func_keyw_id store_type_id
                                          )
                                        )
                                      ) = 
                                      (expression 
                                        (atoms 'NT'
                                        )
                                      )
                                    )
                                  )
                                ) then 
                                (expression 
                                  (keyw_id_part 
                                    (func_keyw_id order_count
                                    )
                                  )
                                )
                              ) 
                              (case_else else 
                                (expression 
                                  (atoms 0
                                  )
                                )
                              ) end
                            )
                          ) 
                        )
                      )
                    )
                  ) 
                  (as_clause as 
                    (func_keyw_id niketown_frequency
                    )
                  )
                )
              ) 
              (into_clause into 
                (keyw_id 
                  (keyw_id_part 
                    (func_keyw_id agg
                    )
                  ) . 
                  (keyw_id_part 
                    (func_keyw_id dbo
                    )
                  ) . 
                  (keyw_id_part 
                    (func_keyw_id retail_store_concept
                    )
                  )
                )
              ) 
              (from_clause from 
                (table_source_list 
                  (table_source 
                    (tableSourceElement 
                      (table_source_primitive 
                        (primitive_table 
                          (keyw_id 
                            (keyw_id_part 
                              (func_keyw_id agg
                              )
                            ) . 
                            (keyw_id_part 
                              (func_keyw_id dbo
                              )
                            ) . 
                            (keyw_id_part 
                              (func_keyw_id retail_store_concept_temp
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              ) 
              (group_by_clause group by 
                (expression_list 
                  (expression 
                    (keyw_id_part 
                      (func_keyw_id mid
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
    )
  ) <EOF>
)