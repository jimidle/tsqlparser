(aaa_translation_unit (batch_statements (statements (sql_statements (select_statement (query_expression (query_specification select (select_list (select_element (expression (expression (keyw_id_part (func_keyw_id a))) . (expression (keyw_id_part (func_keyw_id mid))))) , (select_element (expression (functions_and_vars (aggregate_windowed_functions max ( (expression (case_expression case (case_boolean_when_clause when (search_condition (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id b))) . (expression (keyw_id_part (func_keyw_id mid)))) is not null)) or (search_condition (predicate (expression ( (expression (expression (keyw_id_part (func_keyw_id a))) . (expression (expression (expression (keyw_id_part (func_keyw_id source_flag))) > (expression (atoms 'A128'))) and (expression (expression (keyw_id_part (func_keyw_id allowable_uses))) = (expression (atoms 0))))) ))))) then (expression (atoms 1))) (case_else else (expression (atoms 0))) end)) )))) (as_clause as (func_keyw_id prospect))) , (select_element (expression (keyw_id_part (func_keyw_id (keywords min))))))))))) (statements (sql_statements (select_statement (query_expression (query_specification (paren_sub_query ( (sub_query (select_statement (query_expression (query_specification case when)))) <missing ')'>)))))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id b) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id mid) is null and)))) (statements (sql_statements (select_statement (query_expression (query_specification (paren_sub_query ( (sub_query (select_statement (query_expression (query_specification (paren_sub_query ( (sub_query (select_statement (query_expression query_specification)))))))) <missing ')'>)))))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id a) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id source_flag) > 'A128' and)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id a) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id allowable_uses) > 0 ) or)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id a) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id source_flag) <missing ':'>)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id (keywords between)) 'A001' and 'A128' ) then 1 else 0)))) (statements (sql_statements miscellaneous_statements)) (statements (sql_statements (miscellaneous_statements end )))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id (keywords as)) <missing ':'>)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id rental) into)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id agg) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id dbo) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id prospect_rollup) from)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id kc) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id dbo) .)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id source_history_vertical) <missing ':'>)))) (statements (sql_statements (miscellaneous_statements (goto_statement (func_keyw_id a) <missing ':'>)))) (statements (sql_statements (select_statement (query_expression (query_specification (paren_sub_query ( (sub_query (select_statement (query_expression query_specification))) nolock )))))))) left join agg . dbo . experian_promo b on a . mid = b . mid group by a . mid)