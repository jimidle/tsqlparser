(aaa_translation_unit (batch_statements (statements (sql_statements (use_statement USE (keyw_id (keyw_id_part (func_keyw_id AdventureWorks))) ;))) (statements GO) (statements (sql_statements (miscellaneous_statements (dbcc_statement DBCC (dbcc_showcontig SHOWCONTIG (dbcc_form_1 ( (dbcc_dbname 'HumanResources.Employee') ))) ;)))) (statements GO) (statements (sql_statements (use_statement USE (keyw_id (keyw_id_part (func_keyw_id AdventureWorks))) ;))) (statements GO) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @id))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @indid))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id int))))))))))))) (statements (sql_statements (miscellaneous_statements (set_statement SET (set_vars (set_var_list (keyw_id (keyw_id_part (func_keyw_id @id)))) = (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id OBJECT_ID))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (atoms 'Production.Product'))))) )))))))))) (statements (sql_statements (select_statement (query_expression (query_specification SELECT (select_list (select_element (func_keyw_id @indid) = (expression (keyw_id_part (func_keyw_id index_id))))) (from_clause FROM (table_source_list (table_source (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id (keywords sys))) . (keyw_id_part (func_keyw_id indexes))))))))) (where_clause WHERE (search_condition (predicate (expression (expression (expression (keyw_id_part (func_keyw_id object_id))) = (expression (keyw_id_part (func_keyw_id @id)))) AND (expression (expression (keyw_id_part (func_keyw_id (keywords name)))) = (expression (atoms 'AK_Product_Name')))))))))))) (statements (sql_statements (miscellaneous_statements (dbcc_statement DBCC (dbcc_showcontig SHOWCONTIG (dbcc_form_1 ( (dbcc_dbname (keyw_id (keyw_id_part (func_keyw_id @id)))) , (keyw_id (keyw_id_part (func_keyw_id @indid))) ))) ;)))) (statements GO) (statements (sql_statements (use_statement USE (keyw_id (keyw_id_part (func_keyw_id AdventureWorks))) ;))) (statements GO) (statements (sql_statements (miscellaneous_statements (dbcc_statement DBCC (dbcc_showcontig SHOWCONTIG (dbcc_form_1 ( (dbcc_dbname 'Production.Product') , 1 ) (dbcc_with WITH (dbcc_with_option (keyw_id (keyw_id_part (func_keyw_id (keywords FAST)))))))) ;)))) (statements GO) (statements (sql_statements (use_statement USE (keyw_id (keyw_id_part (func_keyw_id AdventureWorks))) ;))) (statements GO) (statements (sql_statements (miscellaneous_statements (dbcc_statement DBCC (dbcc_showcontig SHOWCONTIG (dbcc_with WITH (dbcc_with_option (keyw_id (keyw_id_part (func_keyw_id TABLERESULTS)))) , (dbcc_with_option (keyw_id (keyw_id_part (func_keyw_id ALL_INDEXES)))))) ;)))) (statements GO) (statements (sql_statements (miscellaneous_statements (set_statement SET (set_vars (set_var_list (keyw_id (keyw_id_part (func_keyw_id NOCOUNT)))) ON) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @tablename))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id varchar))) ( 128 ))))))) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @execstr))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id varchar))) ( 255 ))))))) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @objectid))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id int))))))))) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @indexid))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id int))))))))) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @frag))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id decimal))))))))) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @maxfrag))) (declare_as opt_as (declare_as_opts (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id decimal))))))))) ;)))) (statements (sql_statements (select_statement (query_expression (query_specification SELECT (select_list (select_element (func_keyw_id @maxfrag) = (expression (atoms 30.0)))))) ;))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_cursor (keyw_id (keyw_id_part (func_keyw_id tables))) CURSOR (common_cursor_decl dc_extended_options (dc_for_statement FOR (select_statement (query_expression (query_specification SELECT (select_list (select_element (expression (keyw_id_part (func_keyw_id TABLE_NAME))))) (from_clause FROM (table_source_list (table_source (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id INFORMATION_SCHEMA)) . (keyw_id_part (func_keyw_id TABLES))))))))) (where_clause WHERE (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id TABLE_TYPE))) = (expression (atoms 'BASE TABLE')))))))) ;)))))))) (statements (ddl_statements (create_statement CREATE (create_table TABLE (keyw_id (keyw_id_part (func_keyw_id #fraglist))) ( (ct_col_def_list (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ObjectName))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id char))) ( 255 )))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ObjectId))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id IndexName))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id char))) ( 255 )))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id IndexId))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id Lvl))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id CountPages))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id CountRows))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id MinRecSize))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id MaxRecSize))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id AvgRecSize))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ForRecCount))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id Extents))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ExtentSwitches))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id AvgFreeBytes))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id AvgPageDensity))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ScanDensity))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id decimal)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id BestCount))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ActualCount))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id int)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id LogicalFrag))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id decimal)))))))) , (ct_col_def_list_element (ct_column_def_plus (ct_column_definition (keyw_id (keyw_id_part (func_keyw_id ExtentFrag))) (ct_data_type (ct_data (keyw_id (keyw_id_part (func_keyw_id decimal))))))))) ) ;)))) (statements (sql_statements (miscellaneous_statements (open_statement OPEN (open_cursor (keyw_id (keyw_id_part (func_keyw_id tables)))) ;)))) (statements (sql_statements (cursor_statements (fetch_statement FETCH (fetch_opts NEXT) FROM (fetch_global (keyw_id (keyw_id_part (func_keyw_id tables)))) (fetch_into INTO (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id @tablename))))) ;)))) (statements (sql_statements (miscellaneous_statements (while_statement WHILE (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id @@FETCH_STATUS))) = (expression (atoms 0))))) (statements (sql_statements (miscellaneous_statements (begin_statement BEGIN ; (statement_block (statements (sql_statements (miscellaneous_statements (insert_statement INSERT (insert_into (is_opt_into INTO) (keyw_id (keyw_id_part (func_keyw_id #fraglist)))) (insert_update_target (insert_update_target_tbl (execute_statement (exec_one EXEC (exec_body (exec_sp (exec_string_cmd ( (exec_string_list (exec_string_bit 'DBCC SHOWCONTIG (''') + (exec_string_bit (keyw_id (keyw_id_part (func_keyw_id @tablename)))) + (exec_string_bit ''') \r\n\t      WITH FAST, TABLERESULTS, ALL_INDEXES, NO_INFOMSGS')) ))) ;))))))))) (statements (sql_statements (cursor_statements (fetch_statement FETCH (fetch_opts NEXT) FROM (fetch_global (keyw_id (keyw_id_part (func_keyw_id tables)))) (fetch_into INTO (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id @tablename))))) ;))))) END ;)))))))) (statements (sql_statements (miscellaneous_statements (close_statement CLOSE (keyw_id_part (func_keyw_id tables)) ;)))) (statements (ddl_statements (cursor_ddl (deallocate DEALLOCATE (keyw_id (keyw_id_part (func_keyw_id tables))) ;)))) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_cursor (keyw_id (keyw_id_part (func_keyw_id indexes))) CURSOR (common_cursor_decl dc_extended_options (dc_for_statement FOR (select_statement (query_expression (query_specification SELECT (select_list (select_element (expression (keyw_id_part (func_keyw_id ObjectName)))) , (select_element (expression (keyw_id_part (func_keyw_id ObjectId)))) , (select_element (expression (keyw_id_part (func_keyw_id IndexId)))) , (select_element (expression (keyw_id_part (func_keyw_id LogicalFrag))))) (from_clause FROM (table_source_list (table_source (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id #fraglist))))))))) (where_clause WHERE (search_condition (predicate (expression (expression (expression (keyw_id_part (func_keyw_id LogicalFrag))) >= (expression (keyw_id_part (func_keyw_id @maxfrag)))) AND (expression (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id INDEXPROPERTY))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (keyw_id_part (func_keyw_id ObjectId)))) , (param_list_el (expression (keyw_id_part (func_keyw_id IndexName)))) , (param_list_el (expression (atoms 'IndexDepth'))))) ))))) > (expression (atoms 0))))))))) ;)))))))) (statements (sql_statements (miscellaneous_statements (open_statement OPEN (open_cursor (keyw_id (keyw_id_part (func_keyw_id indexes)))) ;)))) (statements (sql_statements (cursor_statements (fetch_statement FETCH (fetch_opts NEXT) FROM (fetch_global (keyw_id (keyw_id_part (func_keyw_id indexes)))) (fetch_into INTO (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id @tablename))) , (keyw_id (keyw_id_part (func_keyw_id @objectid))) , (keyw_id (keyw_id_part (func_keyw_id @indexid))) , (keyw_id (keyw_id_part (func_keyw_id @frag))))) ;)))) (statements (sql_statements (miscellaneous_statements (while_statement WHILE (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id @@FETCH_STATUS))) = (expression (atoms 0))))) (statements (sql_statements (miscellaneous_statements (begin_statement BEGIN ; (statement_block (statements (sql_statements (miscellaneous_statements (print_statement PRINT (expression (expression (expression (expression (expression (expression (expression (atoms 'Executing DBCC INDEXDEFRAG (0, ')) + (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id RTRIM))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (keyw_id_part (func_keyw_id @tablename)))))) )))))) + (expression (atoms ',\r\n\t\t\t      '))) + (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id RTRIM))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (keyw_id_part (func_keyw_id @indexid)))))) )))))) + (expression (atoms ') - fragmentation currently '))) + (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id RTRIM))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (functions_and_vars (function CONVERT ( (data_type (data_type_el (keyw_id (keyw_id_part (func_keyw_id varchar))) ( 15 ))) , (expression (keyw_id_part (func_keyw_id @frag))) ))))))) )))))) + (expression (atoms '%'))) ;)))) (statements (sql_statements (select_statement (query_expression (query_specification SELECT (select_list (select_element (func_keyw_id @execstr) = (expression (expression (expression (expression (expression (atoms 'DBCC INDEXDEFRAG (0, ')) + (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id RTRIM))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (keyw_id_part (func_keyw_id @objectid)))))) )))))) + (expression (atoms ',\r\n\t\t\t       '))) + (expression (functions_and_vars (function (func_name (keyw_id_for_func (keyw_id_orcc (keyw_id_part (func_keyw_id RTRIM))))) (function_args ( (param_list_or_all (param_list (param_list_el (expression (keyw_id_part (func_keyw_id @indexid)))))) )))))) + (expression (atoms ')'))))))) ;))) (statements (execute_statement (exec_one EXEC (exec_body (exec_sp (exec_string_cmd ( (exec_string_list (exec_string_bit (keyw_id (keyw_id_part (func_keyw_id @execstr))))) ))) ;)))) (statements (sql_statements (cursor_statements (fetch_statement FETCH (fetch_opts NEXT) FROM (fetch_global (keyw_id (keyw_id_part (func_keyw_id indexes)))) (fetch_into INTO (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id @tablename))) , (keyw_id (keyw_id_part (func_keyw_id @objectid))) , (keyw_id (keyw_id_part (func_keyw_id @indexid))) , (keyw_id (keyw_id_part (func_keyw_id @frag))))) ;))))) END ;)))))))) (statements (sql_statements (miscellaneous_statements (close_statement CLOSE (keyw_id_part (func_keyw_id indexes)) ;)))) (statements (ddl_statements (cursor_ddl (deallocate DEALLOCATE (keyw_id (keyw_id_part (func_keyw_id indexes))) ;)))) (statements (ddl_statements (drop_statement DROP (dropCommonList (dropListElements TABLE) (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id #fraglist)))) ;)))) (statements GO)) <EOF>)