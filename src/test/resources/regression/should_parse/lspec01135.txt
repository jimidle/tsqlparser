(aaa_translation_unit (batch_statements (statements (sql_statements (use_statement USE (keyw_id (keyw_id_part (func_keyw_id AdventureWorks2008R2))) ;))) (statements GO) (statements (sql_statements (miscellaneous_statements (declare_statement DECLARE (declare_list (declare_list_item (keyw_id (keyw_id_part (func_keyw_id @SummaryOfChanges))) (declare_as opt_as (declare_as_opts TABLE ( (declare_defs (declare_def (declare_col (keyw_id (keyw_id_part (func_keyw_id Change))) (cr_type_data_type (cr_type_data (keyw_id (keyw_id_part (func_keyw_id VARCHAR))) ( 20 )))))) ))))) ;)))) (statements (sql_statements (miscellaneous_statements (merge_statement MERGE (merge_into (is_opt_into INTO) (keyw_id (keyw_id_part (func_keyw_id Sales)) . (keyw_id_part (func_keyw_id SalesReason))) (as_clause AS (func_keyw_id (keywords Target)))) USING (table_source (tableSourceElement (table_source_primitive (primitive_table ( (derivable_table (insert_update_target_values VALUES (values_list_list ( (iut_values_list (iut_value (expression (atoms 'Recommendation'))) , (iut_value (expression (atoms 'Other')))) ) , ( (iut_values_list (iut_value (expression (atoms 'Review'))) , (iut_value (expression (atoms 'Marketing')))) ) , ( (iut_values_list (iut_value (expression (atoms 'Internet'))) , (iut_value (expression (atoms 'Promotion')))) )))) ) (as_clause AS (func_keyw_id (keywords Source))) (column_aliases ( (func_keyw_id (keywords NewName)) , (func_keyw_id NewReasonType) )))))) (merge_on ON (search_condition (predicate (expression (expression (keyw_id_part (func_keyw_id (keywords Target)))) . (expression (expression (keyw_id_part (func_keyw_id (keywords Name)))) = (expression (expression (keyw_id_part (func_keyw_id (keywords Source)))) . (expression (keyw_id_part (func_keyw_id (keywords NewName))))))))) (merge_matches (when_clauses WHEN MATCHED THEN (merge_matched UPDATE (merge_set_clause SET (merge_set_list (set_vars (set_var_list (keyw_id (keyw_id_part (func_keyw_id ReasonType)))) = (expression (expression (keyw_id_part (func_keyw_id (keywords Source)))) . (expression (keyw_id_part (func_keyw_id NewReasonType))))))))) (when_clauses WHEN NOT MATCHED BY TARGET THEN (merge_not_matched INSERT ( (keyw_id_list (keyw_id (keyw_id_part (func_keyw_id (keywords Name)))) , (keyw_id (keyw_id_part (func_keyw_id ReasonType)))) ) (insert_update_target_values VALUES (values_list_list ( (iut_values_list (iut_value (expression (keyw_id_part (func_keyw_id (keywords NewName))))) , (iut_value (expression (keyw_id_part (func_keyw_id NewReasonType))))) ))))))) (output_clause (output_dml OUTPUT (dml_select_list (dml_select (del_col_name $action)))) INTO (keyw_id (keyw_id_part (func_keyw_id @SummaryOfChanges)))) ;)))) (statements (sql_statements (select_statement (query_expression (query_specification SELECT (select_list (select_element (expression (keyw_id_part (func_keyw_id Change)))) , (select_element (expression (functions_and_vars (aggregate_windowed_functions COUNT ( * )))) (as_clause AS (func_keyw_id CountPerChange)))) (from_clause FROM (table_source_list (table_source (tableSourceElement (table_source_primitive (primitive_table (keyw_id (keyw_id_part (func_keyw_id @SummaryOfChanges))))))))) (group_by_clause GROUP BY (expression_list (expression (keyw_id_part (func_keyw_id Change))))))) ;)))) <EOF>)